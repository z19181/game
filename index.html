<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>éœ“è™¹å¸å›½ | NEON EMPIRE</title>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Noto+Sans+SC:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        * {
            font-family: 'Noto Sans SC', sans-serif;
        }
        
        .cyber-font {
            font-family: 'Orbitron', sans-serif;
        }
        
        body {
            background: #0a0a0f;
            overflow-x: hidden;
        }
        
        /* æ‰«æçº¿æ•ˆæœ */
        .scanlines::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: repeating-linear-gradient(
                0deg,
                rgba(0, 0, 0, 0.1),
                rgba(0, 0, 0, 0.1) 1px,
                transparent 1px,
                transparent 2px
            );
            pointer-events: none;
            z-index: 1000;
        }
        
        /* éœ“è™¹å‘å…‰ */
        .neon-pink {
            text-shadow: 0 0 10px #ff2d95, 0 0 20px #ff2d95, 0 0 40px #ff2d95;
        }
        
        .neon-cyan {
            text-shadow: 0 0 10px #00f7ff, 0 0 20px #00f7ff, 0 0 40px #00f7ff;
        }
        
        .neon-gold {
            text-shadow: 0 0 10px #ffd700, 0 0 20px #ffd700, 0 0 40px #ffd700;
        }
        
        .neon-box-pink {
            box-shadow: 0 0 10px #ff2d95, 0 0 20px rgba(255, 45, 149, 0.5), inset 0 0 20px rgba(255, 45, 149, 0.1);
        }
        
        .neon-box-cyan {
            box-shadow: 0 0 10px #00f7ff, 0 0 20px rgba(0, 247, 255, 0.5), inset 0 0 20px rgba(0, 247, 255, 0.1);
        }
        
        .neon-box-gold {
            box-shadow: 0 0 20px #ffd700, 0 0 40px rgba(255, 215, 0, 0.5), inset 0 0 30px rgba(255, 215, 0, 0.1);
            animation: goldPulse 2s ease-in-out infinite;
        }
        
        @keyframes goldPulse {
            0%, 100% { box-shadow: 0 0 20px #ffd700, 0 0 40px rgba(255, 215, 0, 0.5); }
            50% { box-shadow: 0 0 40px #ffd700, 0 0 80px rgba(255, 215, 0, 0.8); }
        }
        
        /* æ•…éšœæ•ˆæœ */
        @keyframes glitch {
            0% { transform: translate(0); }
            20% { transform: translate(-2px, 2px); }
            40% { transform: translate(-2px, -2px); }
            60% { transform: translate(2px, 2px); }
            80% { transform: translate(2px, -2px); }
            100% { transform: translate(0); }
        }
        
        .glitch:hover {
            animation: glitch 0.3s ease infinite;
        }
        
        /* è¿›åº¦æ¡ */
        .progress-bar {
            background: linear-gradient(90deg, #ff2d95, #ff6b6b, #ffd700);
            background-size: 200% 100%;
            animation: progressGlow 2s linear infinite;
        }
        
        @keyframes progressGlow {
            0% { background-position: 0% 50%; }
            100% { background-position: 200% 50%; }
        }
        
        /* æŒ‰é’®æ‚¬åœ */
        .cyber-btn {
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
        }
        
        .cyber-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: left 0.5s ease;
        }
        
        .cyber-btn:hover::before {
            left: 100%;
        }
        
        /* è§’è‰²å¡ç‰‡ */
        .character-card {
            background: linear-gradient(135deg, rgba(20, 20, 30, 0.9), rgba(40, 20, 60, 0.9));
            border: 1px solid rgba(255, 45, 149, 0.3);
            transition: all 0.3s ease;
        }
        
        .character-card:hover {
            transform: translateY(-5px) scale(1.02);
            border-color: #ff2d95;
        }
        
        /* å¤§å¥–åŠ¨ç”» */
        @keyframes prizeFloat {
            0%, 100% { transform: translateY(0) rotate(-2deg); }
            50% { transform: translateY(-20px) rotate(2deg); }
        }
        
        @keyframes sparkle {
            0%, 100% { opacity: 0; transform: scale(0) rotate(0deg); }
            50% { opacity: 1; transform: scale(1) rotate(180deg); }
        }
        
        .prize-float {
            animation: prizeFloat 3s ease-in-out infinite;
        }
        
        .sparkle {
            animation: sparkle 1.5s ease-in-out infinite;
        }
        
        /* æ’åé—ªçƒ */
        @keyframes rankPulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        .rank-pulse {
            animation: rankPulse 1s ease-in-out infinite;
        }
        
        /* é€‰é¡¹å¡ç‰‡ */
        .choice-card {
            background: linear-gradient(135deg, rgba(20, 20, 40, 0.95), rgba(40, 20, 50, 0.95));
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }
        
        .choice-card:hover {
            border-color: #00f7ff;
            transform: scale(1.02);
            box-shadow: 0 0 30px rgba(0, 247, 255, 0.3);
        }
        
        .choice-card.risky:hover {
            border-color: #ff2d95;
            box-shadow: 0 0 30px rgba(255, 45, 149, 0.3);
        }
        
        /* å¿ƒè·³æ•ˆæœ */
        @keyframes heartbeat {
            0%, 100% { transform: scale(1); }
            25% { transform: scale(1.1); }
            50% { transform: scale(1); }
            75% { transform: scale(1.05); }
        }
        
        .heartbeat {
            animation: heartbeat 1s ease-in-out infinite;
        }
        
        /* å±å¹•éœ‡åŠ¨ */
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
        
        .shake {
            animation: shake 0.5s ease-in-out;
        }
        
        /* æ·¡å…¥åŠ¨ç”» */
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .fade-in-up {
            animation: fadeInUp 0.6s ease-out forwards;
        }
        
        /* ç²’å­æ•ˆæœ */
        .particle {
            position: absolute;
            pointer-events: none;
            border-radius: 50%;
            animation: particleFloat 3s ease-out forwards;
        }
        
        @keyframes particleFloat {
            0% { opacity: 1; transform: translateY(0) scale(1); }
            100% { opacity: 0; transform: translateY(-100px) scale(0); }
        }
        
        /* æ€§æ„Ÿæ¸å˜èƒŒæ™¯ */
        .sexy-gradient {
            background: linear-gradient(135deg, #1a0a1a 0%, #2d1f3d 25%, #1a2a3a 50%, #0f1a2a 75%, #1a0a1a 100%);
        }
        
        /* éœ“è™¹è¾¹æ¡†åŠ¨ç”» */
        @keyframes borderGlow {
            0%, 100% { border-color: #ff2d95; }
            33% { border-color: #00f7ff; }
            66% { border-color: #ffd700; }
        }
        
        .border-animate {
            animation: borderGlow 3s linear infinite;
        }
        
        /* PS5å›¾ç‰‡æ ·å¼ */
        .ps5-image {
            filter: drop-shadow(0 0 30px rgba(0, 150, 255, 0.8)) drop-shadow(0 0 60px rgba(255, 255, 255, 0.5));
        }
        
        @keyframes ps5Glow {
            0%, 100% { filter: drop-shadow(0 0 30px rgba(0, 150, 255, 0.8)) drop-shadow(0 0 60px rgba(255, 255, 255, 0.5)); }
            50% { filter: drop-shadow(0 0 50px rgba(0, 200, 255, 1)) drop-shadow(0 0 100px rgba(255, 255, 255, 0.8)); }
        }
        
        .ps5-glow {
            animation: ps5Glow 2s ease-in-out infinite;
        }
        
        /* é€šå…³è¿›åº¦ */
        .win-progress {
            background: linear-gradient(90deg, #00ff88, #00f7ff, #ff2d95);
            background-size: 200% 100%;
            animation: progressGlow 3s linear infinite;
        }
        
        /* å¼¹çª—åŠ¨ç”» */
        @keyframes modalIn {
            from { opacity: 0; transform: scale(0.8); }
            to { opacity: 1; transform: scale(1); }
        }
        
        .modal-animate {
            animation: modalIn 0.4s ease-out forwards;
        }
        
        /* å½©å¸¦æ•ˆæœ */
        @keyframes confetti {
            0% { transform: translateY(-100vh) rotate(0deg); opacity: 1; }
            100% { transform: translateY(100vh) rotate(720deg); opacity: 0; }
        }
        
        .confetti {
            animation: confetti 3s linear forwards;
        }
    </style>
</head>
<body class="scanlines min-h-screen sexy-gradient text-white">
    
    <!-- é¡¶éƒ¨çŠ¶æ€æ  -->
    <div id="statusBar" class="fixed top-0 left-0 right-0 z-50 bg-black/80 backdrop-blur-sm border-b border-pink-500/30 p-2 hidden">
        <div class="max-w-4xl mx-auto flex items-center justify-between text-sm">
            <!-- æ’åæ˜¾ç¤º -->
            <div class="flex items-center gap-2">
                <span class="text-gray-400">ğŸ† å¤§å¥–å†²åˆºæ’å</span>
                <span class="cyber-font text-yellow-400 neon-gold rank-pulse" id="currentRank">#1,247</span>
                <span class="text-gray-500">/ 12,847</span>
            </div>
            
            <!-- é€šå…³è¿›åº¦ -->
            <div class="flex items-center gap-2">
                <span class="text-gray-400">ğŸ® é€šå…³è¿›åº¦</span>
                <span class="cyber-font text-green-400" id="winCount">0</span>
                <span class="text-gray-500">/ 3</span>
            </div>
            
            <!-- èµ„æº -->
            <div class="flex items-center gap-4">
                <div class="flex items-center gap-1">
                    <span>ğŸ’°</span>
                    <span class="cyber-font text-green-400" id="money">0</span>
                </div>
                <div class="flex items-center gap-1">
                    <span>ğŸ”¥</span>
                    <span class="cyber-font text-pink-400" id="reputation">0</span>
                </div>
                <div class="flex items-center gap-1">
                    <span>âš¡</span>
                    <span class="cyber-font text-cyan-400" id="energy">100</span>
                </div>
            </div>
            
            <!-- æ—¶é—´ -->
            <div class="flex items-center gap-2">
                <span class="text-gray-400">â±ï¸</span>
                <span class="cyber-font text-red-400" id="gameTimer">5:00</span>
            </div>
        </div>
        
        <!-- è¿›åº¦æ¡ -->
        <div class="max-w-4xl mx-auto mt-2">
            <div class="h-1 bg-gray-800 rounded-full overflow-hidden">
                <div class="progress-bar h-full rounded-full transition-all duration-500" id="progressBar" style="width: 0%"></div>
            </div>
            <div class="flex justify-between text-xs text-gray-500 mt-1">
                <span>è°ƒé…’å¸ˆ</span>
                <span>é¢†ç­</span>
                <span>ç»ç†</span>
                <span>åˆä¼™äºº</span>
                <span class="text-yellow-400">ğŸ‘‘ BOSS</span>
            </div>
        </div>
    </div>
    
    <!-- ä¸»æ¸¸æˆå®¹å™¨ -->
    <div id="gameContainer" class="min-h-screen flex items-center justify-center p-4">
        
        <!-- å¼€å§‹ç•Œé¢ -->
        <div id="startScreen" class="text-center max-w-2xl mx-auto">
            <!-- PS5å¤§å¥–å±•ç¤º -->
            <div class="mb-8 relative">
                <div class="prize-float inline-block">
                    <!-- PS5å›¾ç‰‡ -->
                    <div class="relative">
                        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/7/77/PlayStation_5_and_DualSense_with_transparent_background.png/800px-PlayStation_5_and_DualSense_with_transparent_background.png" 
                             alt="PS5" 
                             class="w-64 h-auto mx-auto ps5-glow"
                             onerror="this.style.display='none'; document.getElementById('ps5Fallback').style.display='block';">
                        <div id="ps5Fallback" class="hidden text-8xl">ğŸ®</div>
                    </div>
                </div>
                <div class="absolute inset-0 flex items-center justify-center pointer-events-none">
                    <div class="sparkle absolute text-yellow-400 text-2xl" style="top: 10%; left: 20%;">âœ¦</div>
                    <div class="sparkle absolute text-pink-400 text-xl" style="top: 30%; right: 15%; animation-delay: 0.3s;">âœ§</div>
                    <div class="sparkle absolute text-cyan-400 text-2xl" style="bottom: 20%; left: 10%; animation-delay: 0.6s;">âœ¦</div>
                    <div class="sparkle absolute text-yellow-400 text-xl" style="bottom: 10%; right: 25%; animation-delay: 0.9s;">âœ§</div>
                </div>
                <div class="neon-box-gold rounded-2xl p-4 bg-gradient-to-r from-yellow-900/30 via-yellow-600/20 to-yellow-900/30 border border-yellow-500/50 mt-4">
                    <p class="cyber-font text-yellow-400 text-xl neon-gold">ğŸ® ç»ˆæå¤§å¥– ğŸ®</p>
                    <p class="text-3xl font-bold mt-2">PlayStation 5 æ¸¸æˆä¸»æœº</p>
                    <p class="text-gray-400 mt-2">ä»·å€¼ Â¥4,299 | é€šå…³3æ¬¡å³å¯è·å¾—</p>
                    <p class="text-pink-400 text-sm mt-1">ğŸ€ å¹¸è¿å¥–ï¼šéœ¸å±åˆ¸ x1</p>
                </div>
            </div>
            
            <h1 class="cyber-font text-5xl md:text-7xl font-black mb-4">
                <span class="text-pink-500 neon-pink">NEON</span>
                <span class="text-cyan-400 neon-cyan">EMPIRE</span>
            </h1>
            <p class="text-2xl text-gray-300 mb-2">éœ“ è™¹ å¸ å›½</p>
            <p class="text-pink-400 mb-8">ä»è°ƒé…’å¸ˆåˆ°é…’å§å¸å›½BOSSçš„é€†è¢­ä¹‹è·¯</p>
            
            <!-- å½“å‰ç«äº‰è€… -->
            <div class="bg-black/50 rounded-xl p-4 mb-6 border border-cyan-500/30 neon-box-cyan">
                <p class="text-cyan-400 cyber-font mb-2">ğŸ”¥ å®æ—¶æŒ‘æˆ˜è€…</p>
                <div class="flex justify-center gap-4 text-sm">
                    <span class="text-gray-400">å½“å‰åœ¨çº¿: <span class="text-white">12,847</span></span>
                    <span class="text-gray-400">å¤§å¥–æ¦‚ç‡: <span class="text-yellow-400">0.001%</span></span>
                    <span class="text-gray-400">å†å²è·å¥–: <span class="text-green-400">127</span></span>
                </div>
            </div>
            
            <!-- ç”¨æˆ·é€šå…³è¿›åº¦ -->
            <div class="bg-black/50 rounded-xl p-4 mb-6 border border-green-500/30">
                <div class="flex items-center justify-between mb-2">
                    <span class="text-gray-400">ğŸ¯ ä½ çš„é€šå…³è¿›åº¦</span>
                    <span class="cyber-font text-green-400"><span id="userWinCount">0</span> / 3</span>
                </div>
                <div class="h-3 bg-gray-800 rounded-full overflow-hidden">
                    <div class="win-progress h-full rounded-full transition-all duration-500" id="winProgressBar" style="width: 0%"></div>
                </div>
                <p class="text-xs text-gray-500 mt-2" id="winProgressText">å†é€šå…³ 3 æ¬¡å³å¯è·å¾— PS5 å¤§å¥–ï¼</p>
            </div>
            
            <!-- å¼€å§‹æ¸¸æˆæŒ‰é’® -->
            <div class="flex flex-col items-center gap-4 mb-6">
                <!-- å…è´¹æ¸¸ç©æŒ‰é’® -->
                <button id="freePlayBtn" onclick="showRouteSelection()" class="cyber-btn w-full max-w-sm py-5 rounded-xl bg-gradient-to-r from-green-500 to-cyan-500 text-white text-xl font-bold neon-box-cyan hover:scale-105 transition-transform">
                    ğŸ å…è´¹å¼€å§‹æ¸¸æˆ
                </button>
                
                <!-- å·²ä½¿ç”¨å…è´¹ï¼ˆç½®ç°ï¼‰ -->
                <button id="freePlayUsedBtn" class="hidden w-full max-w-sm py-5 rounded-xl bg-gray-700 text-gray-400 text-xl font-bold cursor-not-allowed opacity-60">
                    âœ“ å…è´¹æ¬¡æ•°å·²ä½¿ç”¨
                </button>
                
                <!-- ä»˜è´¹æ¸¸ç©æŒ‰é’® -->
                <button id="paidPlayBtn" onclick="showRouteSelection()" class="hidden cyber-btn w-full max-w-sm py-5 rounded-xl bg-gradient-to-r from-pink-600 to-purple-600 text-white text-xl font-bold neon-box-pink hover:scale-105 transition-transform">
                    ğŸ’° Â¥10 ç»§ç»­æŒ‘æˆ˜
                </button>
            </div>
            
            <p class="text-gray-600 text-xs mt-8">âš ï¸ æ¸¸æˆåŒ…å«è½»å¾®æˆäººæš—ç¤ºå†…å®¹ï¼Œé€‚åˆ18å²ä»¥ä¸Šç©å®¶</p>
        </div>
        
        <!-- è·¯çº¿é€‰æ‹©å¼¹çª— -->
        <div id="routeModal" class="hidden fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4">
            <div class="bg-gradient-to-b from-gray-900 to-black rounded-2xl p-6 max-w-lg w-full border border-cyan-500/50 neon-box-cyan modal-animate">
                <h2 class="cyber-font text-2xl text-center text-cyan-400 mb-2">ğŸ­ é€‰æ‹©ä½ çš„å‘½è¿ä¹‹è·¯</h2>
                <p class="text-gray-400 text-center text-sm mb-6">ä¸åŒè·¯çº¿ï¼Œä¸åŒçš„æ€§æ„Ÿæ•…äº‹</p>
                
                <div class="flex flex-col gap-4">
                    <button onclick="confirmRouteAndStart('female')" class="cyber-btn choice-card risky p-6 rounded-xl group text-left hover:scale-102 transition-transform">
                        <div class="flex items-center gap-4">
                            <div class="text-5xl">ğŸ‘©â€ğŸ¤</div>
                            <div class="flex-1">
                                <div class="cyber-font text-pink-400 text-xl group-hover:neon-pink">å¥³å›¢è·¯çº¿</div>
                                <div class="text-gray-300 text-sm mt-1">ä»é…’å§æ–°äººåˆ°å¥³ç‹BOSSçš„é€†è¢­</div>
                                <div class="text-pink-500 text-xs mt-2">ğŸ’‹ é­…æƒ‘ Â· é‡å¿ƒ Â· å¾æœ</div>
                            </div>
                            <div class="text-2xl text-pink-400">â†’</div>
                        </div>
                    </button>
                    
                    <button onclick="confirmRouteAndStart('male')" class="cyber-btn choice-card p-6 rounded-xl group text-left hover:scale-102 transition-transform">
                        <div class="flex items-center gap-4">
                            <div class="text-5xl">ğŸ•º</div>
                            <div class="flex-1">
                                <div class="cyber-font text-cyan-400 text-xl group-hover:neon-cyan">ç”·å›¢è·¯çº¿</div>
                                <div class="text-gray-300 text-sm mt-1">ä»è°ƒé…’å¸ˆåˆ°éœ¸é“æ€»è£çš„å´›èµ·</div>
                                <div class="text-cyan-500 text-xs mt-2">ğŸ”¥ é­…åŠ› Â· æƒè°‹ Â· æŒæ§</div>
                            </div>
                            <div class="text-2xl text-cyan-400">â†’</div>
                        </div>
                    </button>
                </div>
                
                <button onclick="closeRouteModal()" class="w-full mt-4 py-3 rounded-xl bg-gray-700 hover:bg-gray-600 transition text-gray-300">
                    å–æ¶ˆ
                </button>
            </div>
        </div>
        
        <!-- æ”¯ä»˜å¼¹çª— -->
        <div id="paymentModal" class="hidden fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4">
            <div class="bg-gradient-to-b from-gray-900 to-black rounded-2xl p-6 max-w-md w-full border border-pink-500/50 neon-box-pink modal-animate">
                <h2 class="cyber-font text-2xl text-center text-pink-400 mb-4">ğŸ’° ç»§ç»­æŒ‘æˆ˜</h2>
                
                <div class="bg-black/50 rounded-xl p-4 mb-4">
                    <div class="flex items-center justify-between mb-2">
                        <span class="text-gray-400">å½“å‰è¿›åº¦</span>
                        <span class="cyber-font text-green-400"><span id="modalWinCount">0</span> / 3</span>
                    </div>
                    <p class="text-sm text-gray-400">è·ç¦» PS5 å¤§å¥–è¿˜éœ€é€šå…³ <span class="text-yellow-400" id="modalRemaining">3</span> æ¬¡</p>
                </div>
                
                <div class="text-center mb-6">
                    <p class="text-gray-300 mb-2">æ”¯ä»˜ <span class="cyber-font text-2xl text-yellow-400">Â¥10</span> ç»§ç»­æ¸¸æˆ</p>
                    <p class="text-xs text-gray-500">æ¯æ¬¡é€šå…³éƒ½ç¦»å¤§å¥–æ›´è¿‘ä¸€æ­¥ï¼</p>
                </div>
                
                <div class="flex gap-3">
                    <button onclick="closePaymentModal()" class="flex-1 py-3 rounded-xl bg-gray-700 hover:bg-gray-600 transition">
                        å–æ¶ˆ
                    </button>
                    <button onclick="processPaymentAndShowRoute()" class="flex-1 py-3 rounded-xl bg-gradient-to-r from-pink-600 to-purple-600 hover:opacity-90 transition cyber-btn">
                        ğŸ’³ ç«‹å³æ”¯ä»˜
                    </button>
                </div>
            </div>
        </div>
        
        <!-- æ¸¸æˆç•Œé¢ -->
        <div id="gameScreen" class="hidden w-full max-w-4xl mx-auto pt-24 pb-8">
            <!-- åœºæ™¯/æ•…äº‹åŒºåŸŸ -->
            <div id="storyArea" class="mb-6">
                <div class="character-card rounded-2xl p-6 mb-4">
                    <div class="flex items-start gap-4">
                        <div class="text-6xl" id="characterEmoji">ğŸ‘¤</div>
                        <div class="flex-1">
                            <div class="flex items-center gap-2 mb-2">
                                <span class="cyber-font text-pink-400" id="characterName">???</span>
                                <span class="text-xs px-2 py-0.5 rounded bg-pink-500/20 text-pink-300" id="characterRole">æœªçŸ¥</span>
                            </div>
                            <p class="text-gray-300 leading-relaxed" id="storyText">
                                æ•…äº‹å¼€å§‹...
                            </p>
                        </div>
                    </div>
                </div>
                
                <!-- åœºæ™¯å›¾ç‰‡/æ°›å›´ -->
                <div id="sceneVisual" class="rounded-xl overflow-hidden h-32 bg-gradient-to-r from-purple-900/50 via-pink-900/30 to-purple-900/50 flex items-center justify-center border border-pink-500/20">
                    <div class="text-center">
                        <div class="text-4xl mb-2" id="sceneEmoji">ğŸ¸</div>
                        <div class="text-gray-400 text-sm" id="sceneName">ç¥ç§˜é…’å§</div>
                    </div>
                </div>
            </div>
            
            <!-- é€‰æ‹©åŒºåŸŸ -->
            <div id="choicesArea" class="space-y-3">
                <!-- åŠ¨æ€ç”Ÿæˆé€‰é¡¹ -->
            </div>
        </div>
        
        <!-- ç»“ç®—ç•Œé¢ -->
        <div id="resultScreen" class="hidden text-center max-w-lg mx-auto">
            <!-- åŠ¨æ€å†…å®¹ -->
        </div>
    </div>
    
    <!-- è·å¥–å¼¹çª— -->
    <div id="prizeModal" class="hidden fixed inset-0 bg-black/90 backdrop-blur-sm z-50 flex items-center justify-center p-4">
        <div id="confettiContainer" class="fixed inset-0 pointer-events-none overflow-hidden"></div>
        <div class="bg-gradient-to-b from-yellow-900/50 to-black rounded-2xl p-8 max-w-lg w-full border-2 border-yellow-500 neon-box-gold modal-animate relative z-10">
            <div class="text-center mb-6">
                <div class="text-6xl mb-4">ğŸ‰</div>
                <h2 class="cyber-font text-3xl text-yellow-400 neon-gold mb-2">æ­å–œè·å¾—å¤§å¥–ï¼</h2>
                <p class="text-white text-xl">PlayStation 5 æ¸¸æˆä¸»æœº</p>
                <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/7/77/PlayStation_5_and_DualSense_with_transparent_background.png/800px-PlayStation_5_and_DualSense_with_transparent_background.png" 
                     alt="PS5" class="w-48 mx-auto my-4 ps5-glow"
                     onerror="this.style.display='none';">
            </div>
            
            <form id="addressForm" class="space-y-4">
                <div>
                    <label class="block text-gray-400 text-sm mb-1">æ”¶ä»¶äººå§“å</label>
                    <input type="text" required class="w-full bg-black/50 border border-gray-600 rounded-lg px-4 py-2 text-white focus:border-yellow-500 focus:outline-none" placeholder="è¯·è¾“å…¥çœŸå®å§“å">
                </div>
                <div>
                    <label class="block text-gray-400 text-sm mb-1">æ‰‹æœºå·ç </label>
                    <input type="tel" required class="w-full bg-black/50 border border-gray-600 rounded-lg px-4 py-2 text-white focus:border-yellow-500 focus:outline-none" placeholder="è¯·è¾“å…¥æ‰‹æœºå·">
                </div>
                <div>
                    <label class="block text-gray-400 text-sm mb-1">æ”¶è´§åœ°å€</label>
                    <textarea required class="w-full bg-black/50 border border-gray-600 rounded-lg px-4 py-2 text-white focus:border-yellow-500 focus:outline-none" rows="2" placeholder="çœå¸‚åŒº+è¯¦ç»†åœ°å€"></textarea>
                </div>
                <button type="submit" class="w-full py-3 rounded-xl bg-gradient-to-r from-yellow-500 to-orange-500 text-black font-bold hover:opacity-90 transition cyber-btn">
                    âœ… ç¡®è®¤é¢†å–å¤§å¥–
                </button>
            </form>
            
            <p class="text-xs text-gray-500 mt-4 text-center">å¥–å“å°†åœ¨7ä¸ªå·¥ä½œæ—¥å†…å¯„å‡ºï¼Œè¯·ç¡®ä¿ä¿¡æ¯å‡†ç¡®</p>
        </div>
    </div>
    
    <!-- å¹¸è¿å¥–å¼¹çª— -->
    <div id="luckyPrizeModal" class="hidden fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4">
        <div class="bg-gradient-to-b from-pink-900/50 to-black rounded-2xl p-6 max-w-md w-full border border-pink-500 neon-box-pink modal-animate">
            <div class="text-center">
                <div class="text-6xl mb-4">ğŸ€</div>
                <h2 class="cyber-font text-2xl text-pink-400 neon-pink mb-2">æ­å–œè·å¾—å¹¸è¿å¥–ï¼</h2>
                <p class="text-white text-xl mb-4">éœ¸å±åˆ¸ x1</p>
                <p class="text-gray-400 text-sm mb-6">å¯åœ¨ä»»æ„ç›´æ’­é—´ä½¿ç”¨ï¼Œè®©å…¨åœºçœ‹åˆ°ä½ çš„IDï¼</p>
                <button onclick="closeLuckyPrizeModal()" class="px-8 py-3 rounded-xl bg-gradient-to-r from-pink-600 to-purple-600 hover:opacity-90 transition cyber-btn">
                    ğŸ æ”¶ä¸‹å¥–åŠ±
                </button>
            </div>
        </div>
    </div>
    
    <!-- ç²’å­å®¹å™¨ -->
    <div id="particleContainer" class="fixed inset-0 pointer-events-none z-40"></div>

    <script>
        // ç”¨æˆ·æ•°æ®ï¼ˆæ¨¡æ‹Ÿæœ¬åœ°å­˜å‚¨ï¼‰
        let userData = {
            totalWins: 0,
            hasFreePlayed: false,
            totalPlays: 0
        };
        
        // ä»localStorageåŠ è½½
        function loadUserData() {
            const saved = localStorage.getItem('neonEmpireUserData');
            if (saved) {
                userData = JSON.parse(saved);
            }
            updateStartScreen();
        }
        
        // ä¿å­˜åˆ°localStorage
        function saveUserData() {
            localStorage.setItem('neonEmpireUserData', JSON.stringify(userData));
        }
        
        // æ›´æ–°å¼€å§‹ç•Œé¢
        function updateStartScreen() {
            document.getElementById('userWinCount').textContent = userData.totalWins;
            const progress = (userData.totalWins / 3) * 100;
            document.getElementById('winProgressBar').style.width = `${progress}%`;
            
            const remaining = 3 - userData.totalWins;
            if (remaining > 0) {
                let difficultyHint = '';
                if (userData.totalWins === 2) {
                    difficultyHint = ' âš ï¸ æœ€åä¸€å…³ä¸ºã€åœ°ç‹±éš¾åº¦ã€‘ï¼';
                }
                document.getElementById('winProgressText').textContent = `å†é€šå…³ ${remaining} æ¬¡å³å¯è·å¾— PS5 å¤§å¥–ï¼${difficultyHint}`;
            } else {
                document.getElementById('winProgressText').textContent = `ğŸ‰ å·²è¾¾æˆé€šå…³ç›®æ ‡ï¼Œç­‰å¾…å¤§å¥–æŠ½å–ï¼`;
            }
            
            // åˆ‡æ¢å…è´¹/ä»˜è´¹æŒ‰é’®çŠ¶æ€
            if (userData.hasFreePlayed) {
                // éšè—å…è´¹æŒ‰é’®ï¼Œæ˜¾ç¤ºç½®ç°çš„å·²ä½¿ç”¨æŒ‰é’®å’Œä»˜è´¹æŒ‰é’®
                document.getElementById('freePlayBtn').classList.add('hidden');
                document.getElementById('freePlayUsedBtn').classList.remove('hidden');
                document.getElementById('paidPlayBtn').classList.remove('hidden');
            } else {
                // æ˜¾ç¤ºå…è´¹æŒ‰é’®
                document.getElementById('freePlayBtn').classList.remove('hidden');
                document.getElementById('freePlayUsedBtn').classList.add('hidden');
                document.getElementById('paidPlayBtn').classList.add('hidden');
            }
        }
        
        // æ¸¸æˆçŠ¶æ€
        let gameState = {
            route: 'female',
            money: 0,
            reputation: 0,
            energy: 100,
            stage: 0,
            chapter: 0,
            choices: [],
            startTime: null,
            totalTime: 300,
            rank: 1247,
            alive: true,
            perfect: true,
            pendingRoute: null
        };
        
        // æ•…äº‹ç« èŠ‚ï¼ˆä¿æŒä¹‹å‰çš„æ•…äº‹å†…å®¹ï¼Œè°ƒæ•´éš¾åº¦è®©ç¬¬ä¸€æ¬¡åŸºæœ¬èƒ½é€šå…³15-16ï¼‰
        const stories = {
            female: [
                {
                    scenes: [
                        {
                            character: 'ğŸ‘©â€ğŸ’¼',
                            name: 'æ—å¨œ',
                            role: 'é…’å§è€æ¿',
                            text: '"æ¬¢è¿æ¥åˆ°ã€Œéœ“è™¹ä¹‹å¤œã€ï¼Œå°å¦ã€‚æˆ‘å¬è¯´ä½ æƒ³åœ¨è¿™æ··å‡ºåå ‚ï¼Ÿ" å¥¹çš„çœ¼ç¥ä»ä½ çš„è„¸åºç¼“ç¼“æ‰«è¿‡ï¼Œå˜´è§’å‹¾èµ·ä¸€æŠ¹æ„å‘³æ·±é•¿çš„ç¬‘ã€‚',
                            scene: 'ğŸŒƒ',
                            sceneName: 'éœ“è™¹ä¹‹å¤œÂ·é…’å§å¤§å…',
                            choices: [
                                { text: 'ğŸ’‹ "å§å§ï¼Œæˆ‘ä¼šè®©ä½ çŸ¥é“ä»€ä¹ˆæ˜¯æƒŠå–œçš„ã€‚"', effect: { reputation: 20, money: 0 }, risk: 0.05, next: 1 },
                                { text: 'ğŸ˜Š "æˆ‘ä¼šåŠªåŠ›å­¦ä¹ ï¼Œä¸è¾œè´Ÿæ‚¨çš„æœŸæœ›ã€‚"', effect: { reputation: 5, money: 10 }, risk: 0, next: 1 },
                                { text: 'ğŸ˜ "è¿™é…’å§ä»¥åä¼šæ˜¯æˆ‘çš„ã€‚"', effect: { reputation: 30, money: -10 }, risk: 0.15, next: 1 }
                            ]
                        },
                        {
                            character: 'ğŸ§‘â€ğŸ¤',
                            name: 'è‰¾ä¼¦',
                            role: 'å½“çº¢ç”·å›¢é˜Ÿé•¿',
                            text: 'ä»–é è¿‘ä½ çš„è€³è¾¹ï¼Œä½æ²‰çš„å—“éŸ³å¸¦ç€ç£æ€§ï¼š"æ–°æ¥çš„ï¼Ÿæˆ‘å–œæ¬¢æœ‰é‡å¿ƒçš„å¥³äºº..." ä»–çš„æ‰‹æŒ‡è½»è½»åˆ’è¿‡ä½ çš„ä¸‹å·´ã€‚',
                            scene: 'ğŸ¸',
                            sceneName: 'VIPåŒ…å¢',
                            choices: [
                                { text: 'ğŸ”¥ é¡ºåŠ¿é è¿‘ä»–ï¼Œåœ¨ä»–è€³è¾¹ä½è¯­ï¼š"é‚£è¦çœ‹ä½ é…ä¸é…å¾—ä¸Šã€‚"', effect: { reputation: 25, energy: -10 }, risk: 0.08, next: 2 },
                                { text: 'ğŸ˜Œ åé€€ä¸€æ­¥ï¼Œå¾®ç¬‘ï¼š"å·¥ä½œæ—¶é—´ï¼Œä¿æŒä¸“ä¸šã€‚"', effect: { reputation: 10, money: 20 }, risk: 0, next: 2 },
                                { text: 'ğŸ’¢ "åˆ«ç¢°æˆ‘ï¼Œä½ ä¸æ˜¯æˆ‘çš„èœã€‚"', effect: { reputation: -10, energy: 10 }, risk: 0.2, next: 2 }
                            ]
                        },
                        {
                            character: 'ğŸ‘¯â€â™€ï¸',
                            name: 'å°é›¨',
                            role: 'èµ„æ·±è°ƒé…’å¸ˆ',
                            text: '"å¦¹å¦¹ï¼Œè¿™é‡Œæœ‰ä¸ªæ½œè§„åˆ™..." å¥¹å‹ä½å£°éŸ³ï¼Œ"VIPå®¢äººç‚¹åè¦ä½ é™ªé…’ï¼Œæ¥è¿˜æ˜¯ä¸æ¥ï¼Ÿè¿™å¯å…³ç³»åˆ°ä½ èƒ½ä¸èƒ½ç•™ä¸‹æ¥ã€‚"',
                            scene: 'ğŸ¹',
                            sceneName: 'å§å°åæ–¹',
                            choices: [
                                { text: 'ğŸ­ "æ¥ï¼ä½†æˆ‘è¦ç”¨æˆ‘çš„æ–¹å¼ã€‚"', effect: { money: 50, reputation: 15, energy: -20 }, risk: 0.1, next: 'stage1' },
                                { text: 'ğŸ™…â€â™€ï¸ "ä¸æ¥ï¼Œæˆ‘é å®åŠ›è¯´è¯ã€‚"', effect: { reputation: 20, money: -20 }, risk: 0.12, next: 'stage1' },
                                { text: 'ğŸ¤” "èƒ½ä¸èƒ½å‘Šè¯‰æˆ‘æ›´å¤šæƒ…å†µï¼Ÿ"', effect: { reputation: 5, money: 10 }, risk: 0.02, next: 'stage1' }
                            ]
                        }
                    ]
                },
                {
                    scenes: [
                        {
                            character: 'ğŸ¤',
                            name: 'ä½ ',
                            role: 'æ–°æ™‹é¢†ç­',
                            text: 'ä¸‰ä¸ªæœˆåï¼Œä½ å·²ç»æˆä¸ºé…’å§çš„æ˜æ˜Ÿé¢†ç­ã€‚ä»Šæ™šæœ‰ä¸ªå¤§å®¢æˆ·â€”â€”ä¼ è¯´ä¸­çš„"é‡‘èä¹‹ç‹¼"è¦æ¥ã€‚æ‰€æœ‰äººéƒ½åœ¨è®®è®ºä»–çš„å“å‘³...å’ŒåºŠä¸ŠåŠŸå¤«ã€‚',
                            scene: 'âœ¨',
                            sceneName: 'æ›´è¡£å®¤',
                            choices: [
                                { text: 'ğŸ‘— æ¢ä¸Šé‚£å¥—æœ€æ€§æ„Ÿçš„ç¤¼æœï¼Œä»Šæ™šåŠ¿åœ¨å¿…å¾—', effect: { reputation: 30, energy: -15 }, risk: 0.1, next: 1 },
                                { text: 'ğŸ’¼ ä¿æŒèŒä¸šè£…æ‰®ï¼Œç”¨ä¸“ä¸šå¾æœä»–', effect: { reputation: 15, money: 30 }, risk: 0.05, next: 1 },
                                { text: 'ğŸ­ å…ˆè§‚å¯Ÿï¼Œå†å†³å®šç­–ç•¥', effect: { reputation: 10, energy: 5 }, risk: 0.02, next: 1 }
                            ]
                        },
                        {
                            character: 'ğŸ’¼',
                            name: 'é™ˆé»˜',
                            role: 'é‡‘èä¹‹ç‹¼',
                            text: '"æœ‰æ„æ€..." ä»–æ”¾ä¸‹çº¢é…’æ¯ï¼Œçœ¼ä¸­é—ªè¿‡ä¸€ä¸ç©å‘³ï¼Œ"ç¬¬ä¸€ä¸ªæ•¢ç›´è§†æˆ‘çœ¼ç›çš„å¥³äººã€‚å‘Šè¯‰æˆ‘ï¼Œä½ æƒ³è¦ä»€ä¹ˆï¼Ÿ"',
                            scene: 'ğŸ¥‚',
                            sceneName: 'é¡¶å±‚VIPå…',
                            choices: [
                                { text: 'ğŸ’° "æŠ•èµ„ã€‚æˆ‘è¦å¼€è‡ªå·±çš„é…’å§ã€‚"', effect: { money: 100, reputation: 20 }, risk: 0.12, next: 2 },
                                { text: 'ğŸ’‹ "ç°åœ¨ï¼Ÿæˆ‘æƒ³è¦ä½ ä»Šæ™šçš„æ—¶é—´ã€‚"', effect: { reputation: 50, energy: -30 }, risk: 0.18, next: 2 },
                                { text: 'ğŸ¯ "åˆä½œã€‚äº’åˆ©å…±èµ¢çš„é‚£ç§ã€‚"', effect: { money: 60, reputation: 30 }, risk: 0.08, next: 2 }
                            ]
                        },
                        {
                            character: 'ğŸ˜ˆ',
                            name: 'æ—å¨œ',
                            role: 'é…’å§è€æ¿',
                            text: '"ä½ å’Œé™ˆé»˜èµ°å¾—å¾ˆè¿‘å•Š..." å¥¹çš„æŒ‡ç”²æ•²æ‰“ç€æ¡Œé¢ï¼Œ"åˆ«å¿˜äº†ï¼Œæ˜¯è°æŠŠä½ å¸¦è¿›è¿™ä¸ªåœˆå­çš„ã€‚è¦åˆ†æ¸…æ¥šï¼Œè°æ‰æ˜¯ä½ çš„ä¸»äººã€‚"',
                            scene: 'ğŸŒ¹',
                            sceneName: 'è€æ¿åŠå…¬å®¤',
                            choices: [
                                { text: 'âš”ï¸ "æ—å§ï¼Œè¿™é‡Œæ—©æ™šæ˜¯æˆ‘çš„ã€‚è°¢è°¢ä½ çš„æ•™å¯¼ã€‚"', effect: { reputation: 40, money: -50 }, risk: 0.25, next: 'stage2' },
                                { text: 'ğŸ™‡â€â™€ï¸ "å§ï¼Œæˆ‘æ°¸è¿œè®°å¾—æ‚¨çš„æ©æƒ…ã€‚"', effect: { reputation: -10, money: 50 }, risk: 0.05, next: 'stage2' },
                                { text: 'ğŸ¤ "æˆ‘ä»¬å¯ä»¥æˆä¸ºåˆä½œä¼™ä¼´ï¼Œè€Œä¸æ˜¯å¯¹æ‰‹ã€‚"', effect: { reputation: 25, money: 25 }, risk: 0.1, next: 'stage2' }
                            ]
                        }
                    ]
                },
                {
                    scenes: [
                        {
                            character: 'ğŸ“±',
                            name: 'åŒ¿å',
                            role: 'ç¥ç§˜æ¥ç”µ',
                            text: '"æˆ‘æœ‰ä½ å’Œé™ˆé»˜çš„ç…§ç‰‡ã€‚50ä¸‡ï¼Œæˆ–è€…æ˜å¤©å…¨ç½‘éƒ½ä¼šçŸ¥é“é‡‘èä¹‹ç‹¼çš„æ–°æ¬¢æ˜¯ä¸ªé…’å§å¥³ã€‚" ç”µè¯é‚£å¤´ä¼ æ¥é˜´å†·çš„ç¬‘å£°ã€‚',
                            scene: 'ğŸŒ™',
                            sceneName: 'æ·±å¤œÂ·å…¬å¯“',
                            choices: [
                                { text: 'ğŸ’ª "å‘å§ã€‚æˆ‘ä¸æ€•ã€‚é¡ºä¾¿å¸®æˆ‘ç‚’ä½œä¸€ä¸‹ã€‚"', effect: { reputation: -30, energy: -20 }, risk: 0.3, next: 1, special: 'brave' },
                                { text: 'ğŸ¤« "è§é¢è°ˆã€‚æˆ‘æƒ³çŸ¥é“ä½ è¿˜æœ‰ä»€ä¹ˆã€‚"', effect: { money: -20, reputation: 10 }, risk: 0.15, next: 1 },
                                { text: 'ğŸ“ ç«‹åˆ»æ‰“ç»™é™ˆé»˜ï¼Œè®©ä»–å¤„ç†', effect: { money: 30, reputation: -20 }, risk: 0.1, next: 1 }
                            ]
                        },
                        {
                            character: 'ğŸ‘Š',
                            name: 'é»‘å¸®è€å¤§',
                            role: 'åœ°ä¸‹åŠ¿åŠ›',
                            text: '"å°å¦ï¼Œä½ åŠ¨äº†æˆ‘çš„åœ°ç›˜ã€‚" å‡ ä¸ªé»‘è¡£äººå›´ä½äº†ä½ ï¼Œ"è¦ä¹ˆç»™æˆ‘å¹²æ´»ï¼Œè¦ä¹ˆ...ä½ æ‡‚çš„ã€‚"',
                            scene: 'ğŸš¨',
                            sceneName: 'å°å··Â·å±æœº',
                            choices: [
                                { text: 'ğŸ’£ äº®å‡ºè—åœ¨åŒ…é‡Œçš„å½•éŸ³ç¬”ï¼š"ä½ ç¡®å®šè¦è¿™ä¹ˆåšï¼Ÿ"', effect: { reputation: 60, money: 50 }, risk: 0.35, next: 2 },
                                { text: 'ğŸƒâ€â™€ï¸ è¶æœºé€ƒè·‘ï¼Œå…ˆä¿å‘½', effect: { energy: -40, reputation: -20 }, risk: 0.2, next: 2 },
                                { text: 'ğŸ¤ "è°ˆæ¡ä»¶ã€‚æˆ‘èƒ½ç»™ä½ æ›´å¤šã€‚"', effect: { money: -80, reputation: 20 }, risk: 0.12, next: 2 }
                            ]
                        },
                        {
                            character: 'ğŸ’”',
                            name: 'è‰¾ä¼¦',
                            role: 'æ—§æƒ…äºº',
                            text: 'ä»–å‡ºç°åœ¨ä½ é¢å‰ï¼Œçœ¼çœ¶å¾®çº¢ï¼š"ä¸ºä»€ä¹ˆé€‰ä»–ä¸é€‰æˆ‘ï¼Ÿæˆ‘å¯ä»¥ç»™ä½ ä¸€åˆ‡..." ä»–æ¡ä½ä½ çš„æ‰‹ï¼Œ"æœ€åä¸€æ¬¡æœºä¼šï¼Œè·Ÿæˆ‘èµ°ã€‚"',
                            scene: 'ğŸ’«',
                            sceneName: 'å¤©å°Â·æŠ‰æ‹©',
                            choices: [
                                { text: 'â„ï¸ "è‰¾ä¼¦ï¼Œçˆ±æƒ…ä¸æ˜¯äº¤æ˜“ã€‚å†è§ã€‚"', effect: { reputation: 30, energy: -10 }, risk: 0.08, next: 'stage3' },
                                { text: 'ğŸ’• "å¥½ï¼Œæˆ‘è·Ÿä½ èµ°ã€‚"', effect: { reputation: -50, money: -100 }, risk: 0.5, next: 'badend' },
                                { text: 'ğŸ­ "ç»™æˆ‘æ—¶é—´ï¼Œè®©æˆ‘å¤„ç†å®Œæ‰‹å¤´çš„äº‹ã€‚"', effect: { reputation: 10, energy: -5 }, risk: 0.15, next: 'stage3' }
                            ]
                        }
                    ]
                },
                {
                    scenes: [
                        {
                            character: 'ğŸ‘‘',
                            name: 'ä½ ',
                            role: 'æ–°æ™‹åˆä¼™äºº',
                            text: 'æ—å¨œçš„é…’å§å‡ºäº‹äº†ï¼Œèµ„é‡‘é“¾æ–­è£‚ã€‚ä½ æ‰‹æ¡é™ˆé»˜çš„æŠ•èµ„æ„å‘ä¹¦ï¼Œç«™åœ¨è¿™ä¸ªåå­—è·¯å£ã€‚æ˜¯æ—¶å€™äº†ã€‚',
                            scene: 'ğŸŒ†',
                            sceneName: 'åŸå¸‚ä¹‹å·…',
                            choices: [
                                { text: 'ğŸ—¡ï¸ æ”¶è´­ï¼è¿™ä¸€å¤©æˆ‘ç­‰å¤ªä¹…äº†', effect: { money: 200, reputation: 50 }, risk: 0.2, next: 1 },
                                { text: 'ğŸ¤ "æ—å§ï¼Œæˆ‘æ¥å¸®ä½ ï¼Œä½†æˆ‘è¦40%è‚¡ä»½ã€‚"', effect: { money: 100, reputation: 70 }, risk: 0.1, next: 1 },
                                { text: 'ğŸ’€ "çœ‹çœ‹è¿˜æœ‰è°æƒ³åˆ†ä¸€æ¯ç¾¹"', effect: { money: 150, reputation: 30 }, risk: 0.18, next: 1 }
                            ]
                        },
                        {
                            character: 'ğŸª',
                            name: 'ç³»ç»Ÿ',
                            role: 'æœ€ç»ˆè¯•ç‚¼',
                            text: 'æ‰€æœ‰åŠ¿åŠ›éƒ½åœ¨çœ‹ç€ä½ ã€‚é»‘å¸®è¦åˆ†æˆï¼Œé™ˆé»˜è¦å›æŠ¥ï¼Œæ—å¨œè¦å¤ä»‡ï¼Œè‰¾ä¼¦è¿˜åœ¨çº ç¼ ã€‚æœ€åä¸€æ­¥ï¼Œä½ é€‰æ‹©...',
                            scene: 'âš¡',
                            sceneName: 'ç»ˆå±€ä¹‹æˆ˜',
                            choices: [
                                { text: 'ğŸ‘¸ å…¨éƒ¨æ”¶å…¥å›Šä¸­â€”â€”æˆ‘æ‰æ˜¯è¿™é‡Œçš„å¥³ç‹', effect: { money: 300, reputation: 100 }, risk: 0.4, next: 2, final: true },
                                { text: 'ğŸŒ¹ ä¸å„æ–¹å’Œè§£ï¼Œå»ºç«‹è”ç›Ÿ', effect: { money: 200, reputation: 150 }, risk: 0.15, next: 2, final: true },
                                { text: 'ğŸ”¥ å¼•çˆ†æ‰€æœ‰ç§˜å¯†ï¼Œé‡æ–°æ´—ç‰Œ', effect: { money: 100, reputation: 200 }, risk: 0.28, next: 2, final: true }
                            ]
                        },
                        {
                            character: 'ğŸ†',
                            name: 'å‘½è¿',
                            role: 'æœ€ç»ˆå®¡åˆ¤',
                            text: 'ä½ çš„å¸å›½å³å°†å»ºæˆã€‚ä½†å‘½è¿è¿˜æœ‰æœ€åä¸€é“è€ƒéªŒâ€”â€”"ä½ å‡†å¤‡å¥½äº†å—ï¼Œæœªæ¥çš„BOSSï¼Ÿ"',
                            scene: 'ğŸ°',
                            sceneName: 'å‘½è¿ä¹‹è½®',
                            choices: [
                                { text: 'ğŸ‘‘ "æˆ‘ç”Ÿæ¥å°±æ˜¯å¥³ç‹ã€‚"', effect: { reputation: 50 }, risk: 0.55, next: 'ending', final: true },
                                { text: 'ğŸ™ "æ„Ÿè°¢æ‰€æœ‰å¸®åŠ©è¿‡æˆ‘çš„äººã€‚"', effect: { reputation: 30, money: 50 }, risk: 0.35, next: 'ending', final: true },
                                { text: 'ğŸ˜ˆ "æ¸¸æˆæ‰åˆšåˆšå¼€å§‹ã€‚"', effect: { reputation: 100, money: -50 }, risk: 0.45, next: 'ending', final: true }
                            ]
                        }
                    ]
                }
            ],
            male: [
                {
                    scenes: [
                        {
                            character: 'ğŸ‘¨â€ğŸ’¼',
                            name: 'è€ç‹',
                            role: 'é…’å§è€æ¿',
                            text: '"å°å­ï¼Œæƒ³åœ¨æˆ‘è¿™æ··ï¼Ÿ" ä»–åå‡ºä¸€å£çƒŸåœˆï¼Œ"å…ˆè¯æ˜ä½ æœ‰é‚£ä¸ªèƒ½è€è®©å°å§ä»¬å¿ƒç”˜æƒ…æ„¿ä¸ºä½ å–é…’ã€‚"',
                            scene: 'ğŸŒƒ',
                            sceneName: 'éœ“è™¹ä¹‹å¤œÂ·åå°',
                            choices: [
                                { text: 'ğŸ˜ "ç‹å“¥ï¼Œä¸‰ä¸ªæœˆåè¿™ä½ç½®æ˜¯æˆ‘çš„ã€‚"', effect: { reputation: 25, money: 0 }, risk: 0.08, next: 1 },
                                { text: 'ğŸ™ "æˆ‘ä¼šç”¨ä¸šç»©è¯´è¯ã€‚"', effect: { reputation: 10, money: 15 }, risk: 0.02, next: 1 },
                                { text: 'ğŸ’ª "æˆ‘ä¸ä»…è¦è¿™ä½ç½®ï¼Œè¿˜è¦æ•´ä¸ªé…’å§ã€‚"', effect: { reputation: 35, money: -10 }, risk: 0.18, next: 1 }
                            ]
                        },
                        {
                            character: 'ğŸ’ƒ',
                            name: 'å°ç¾',
                            role: 'èŠ±é­èˆå¨˜',
                            text: 'å¥¹æ¬¾æ¬¾èµ°æ¥ï¼Œçº¢å”‡å¾®å¯ï¼š"æ–°æ¥çš„å¼Ÿå¼Ÿï¼Ÿ" å¥¹çš„æ‰‹æŒ‡åˆ’è¿‡ä½ çš„èƒ¸è†›ï¼Œ"æƒ³åœ¨è¿™ç”Ÿå­˜ï¼Œå¾—å…ˆå­¦ä¼šè®¨å¥½å¥³äººã€‚è¦æˆ‘æ•™ä½ å—ï¼Ÿ"',
                            scene: 'ğŸ¸',
                            sceneName: 'èˆæ± è¾¹',
                            choices: [
                                { text: 'ğŸ”¥ æ¡ä½å¥¹çš„æ‰‹ï¼š"å§å§æƒ³æ•™ä»€ä¹ˆï¼Œæˆ‘éƒ½å­¦ã€‚"', effect: { reputation: 25, energy: -10 }, risk: 0.08, next: 2 },
                                { text: 'ğŸ˜ "æˆ‘æ›´æƒ³æ•™ä½ ç‚¹æ–°ä¸œè¥¿ã€‚"', effect: { reputation: 35, money: -10 }, risk: 0.15, next: 2 },
                                { text: 'ğŸ™‚ "è°¢è°¢ï¼Œä½†æˆ‘æƒ³é è‡ªå·±ã€‚"', effect: { reputation: 5, money: 20 }, risk: 0.05, next: 2 }
                            ]
                        },
                        {
                            character: 'ğŸ‘”',
                            name: 'é˜¿æ°',
                            role: 'é¢†ç­',
                            text: '"å…„å¼Ÿï¼Œå¯Œå©†åŒ…åœºï¼Œç‚¹åè¦å¸…å“¥ä½œé™ªã€‚å»ä¸å»ï¼Ÿå°è´¹äº”ä½æ•°èµ·ã€‚" ä»–æ„å‘³æ·±é•¿åœ°çœ‹ç€ä½ ã€‚',
                            scene: 'ğŸ’°',
                            sceneName: 'æ›´è¡£å®¤',
                            choices: [
                                { text: 'ğŸ­ "å»ï¼æœ‰é’±ä¸èµšæ˜¯å‚»å­ã€‚"', effect: { money: 80, reputation: 10, energy: -25 }, risk: 0.12, next: 'stage1' },
                                { text: 'ğŸš« "æˆ‘ä¸åšé‚£ç§äº‹ã€‚"', effect: { reputation: 15, money: -10 }, risk: 0.1, next: 'stage1' },
                                { text: 'ğŸ¤” "èƒ½ç»™æˆ‘æ›´å¤šç»†èŠ‚å—ï¼Ÿ"', effect: { reputation: 5, money: 10 }, risk: 0.05, next: 'stage1' }
                            ]
                        }
                    ]
                },
                {
                    scenes: [
                        {
                            character: 'ğŸ’',
                            name: 'åˆ˜æ€»',
                            role: 'ç¥ç§˜å¯Œå©†',
                            text: '"æˆ‘å–œæ¬¢æœ‰é‡å¿ƒçš„ç”·äººã€‚" å¥¹æ”¾ä¸‹é¦™æ§Ÿæ¯ï¼Œ"å‘Šè¯‰æˆ‘ï¼Œä½ çš„é‡å¿ƒæ˜¯ä»€ä¹ˆï¼Ÿè®©æˆ‘çœ‹çœ‹å€¼ä¸å€¼å¾—æŠ•èµ„ä½ ã€‚"',
                            scene: 'ğŸ¥‚',
                            sceneName: 'ç§äººä¼šæ‰€',
                            choices: [
                                { text: 'ğŸ‘‘ "æ•´ä¸ªåŸå¸‚çš„å¤œåœºï¼Œéƒ½ä¼šæ˜¯æˆ‘çš„ã€‚"', effect: { reputation: 40, money: 100 }, risk: 0.15, next: 1 },
                                { text: 'ğŸ’‹ "ç°åœ¨ï¼Œæˆ‘åªæƒ³æŠ•èµ„æˆ‘ä»¬ä¹‹é—´çš„æ—¶é—´ã€‚"', effect: { reputation: 50, energy: -30 }, risk: 0.2, next: 1 },
                                { text: 'ğŸ’¼ "æˆ‘æƒ³è¦çš„æ˜¯åˆä½œä¼™ä¼´ï¼Œä¸æ˜¯é‡‘ä¸»ã€‚"', effect: { money: 50, reputation: 30 }, risk: 0.1, next: 1 }
                            ]
                        },
                        {
                            character: 'ğŸ˜ˆ',
                            name: 'è€ç‹',
                            role: 'é…’å§è€æ¿',
                            text: '"å°å­ï¼Œä½ çš„é‡å¿ƒæˆ‘çœ‹åˆ°äº†ã€‚" ä»–æ”¾ä¸‹é…’æ¯ï¼Œ"ä½†ä½ è¸©è¿‡ç•Œäº†ã€‚è¦ä¹ˆæ»šï¼Œè¦ä¹ˆ...æ”¶è´­æˆ‘çš„è‚¡ä»½ã€‚ä½ é€‰ã€‚"',
                            scene: 'âš”ï¸',
                            sceneName: 'è€æ¿åŠå…¬å®¤',
                            choices: [
                                { text: 'ğŸ’° "å¼€ä»·å§ã€‚"', effect: { money: -150, reputation: 50 }, risk: 0.15, next: 2 },
                                { text: 'ğŸ¤ "æˆ‘ä»¬å¯ä»¥ä¸€èµ·åšå¤§ã€‚"', effect: { money: 30, reputation: 30 }, risk: 0.1, next: 2 },
                                { text: 'ğŸ”¥ "ä½ çš„è‚¡ä»½å€¼å¤šå°‘ï¼Œçœ‹æˆ‘å¿ƒæƒ…ã€‚"', effect: { reputation: 40, money: 0 }, risk: 0.28, next: 2 }
                            ]
                        },
                        {
                            character: 'ğŸ’”',
                            name: 'å°ç¾',
                            role: 'æ—§æƒ…äºº',
                            text: 'å¥¹æµç€æ³ªå µä½ä½ ï¼š"ä½ å˜äº†...é‚£ä¸ªè¯´è¦ä¿æŠ¤æˆ‘çš„ç”·äººå»å“ªäº†ï¼Ÿ" å¥¹æŠ“ä½ä½ çš„è¡£é¢†ï¼Œ"å¸¦æˆ‘èµ°ï¼Œç¦»å¼€è¿™ä¸ªåœ°æ–¹ã€‚"',
                            scene: 'ğŸŒ™',
                            sceneName: 'åå··',
                            choices: [
                                { text: 'â„ï¸ "å¯¹ä¸èµ·ï¼Œæˆ‘é€‰æ‹©äº†è¿™æ¡è·¯ã€‚"', effect: { reputation: 20, energy: -10 }, risk: 0.08, next: 'stage2' },
                                { text: 'ğŸ’• "å¥½ï¼Œæˆ‘ä»¬ä¸€èµ·ç¦»å¼€ã€‚"', effect: { reputation: -60, money: -100 }, risk: 0.5, next: 'badend' },
                                { text: 'ğŸ­ "ç­‰æˆ‘ï¼Œå¾ˆå¿«å°±ä¼šæ¥ä½ èµ°ã€‚"', effect: { reputation: 5, energy: -5 }, risk: 0.18, next: 'stage2' }
                            ]
                        }
                    ]
                },
                {
                    scenes: [
                        {
                            character: 'ğŸ”«',
                            name: 'é»‘å¸®',
                            role: 'åœ°ä¸‹åŠ¿åŠ›',
                            text: '"æ–°æ€»è£ï¼Ÿ" ä»–ä»¬å›´ä½ä½ ï¼Œ"è¿™åœ°ç›˜çš„ä¿æŠ¤è´¹ï¼Œä½ æ‰“ç®—æ€ä¹ˆäº¤ï¼Ÿè¿˜æ˜¯è¯´ï¼Œä½ æƒ³ç”¨å¦ä¸€ç§æ–¹å¼...åˆä½œï¼Ÿ"',
                            scene: 'ğŸš¨',
                            sceneName: 'åœ°ä¸‹åœè½¦åœº',
                            choices: [
                                { text: 'ğŸ’° "å¼€ä»·ã€‚æˆ‘ä»˜å¾—èµ·ã€‚"', effect: { money: -100, reputation: 10 }, risk: 0.1, next: 1 },
                                { text: 'ğŸ¤ "åˆä½œå¬èµ·æ¥ä¸é”™ï¼Œè¯´è¯´çœ‹ã€‚"', effect: { money: 50, reputation: -20 }, risk: 0.18, next: 1 },
                                { text: 'ğŸ’£ äº®å‡ºè—èµ·æ¥çš„å½•éŸ³ï¼š"ä½ ä»¬ç¡®å®šï¼Ÿ"', effect: { reputation: 70, money: 30 }, risk: 0.35, next: 1 }
                            ]
                        },
                        {
                            character: 'ğŸ‘¨â€ğŸ’¼',
                            name: 'ç«äº‰å¯¹æ‰‹',
                            role: 'å¤œåº—å¤§äº¨',
                            text: '"å¬è¯´æœ‰ä¸ªå°å­æƒ³åœ¨æˆ‘çš„åœ°ç›˜ç§°ç‹ï¼Ÿ" ä»–ç¬‘äº†ï¼Œ"æ¥ï¼Œè·Ÿæˆ‘å–ä¸€æ¯ï¼Œè°ˆè°ˆä½ çš„å‘½å€¼å¤šå°‘é’±ã€‚"',
                            scene: 'ğŸ™ï¸',
                            sceneName: 'å¯¹æ‰‹çš„é…’å§',
                            choices: [
                                { text: 'ğŸ˜ "ä¸å¦‚è°ˆè°ˆä½ çš„é…’å§å€¼å¤šå°‘ã€‚"', effect: { reputation: 50, money: 50 }, risk: 0.25, next: 2 },
                                { text: 'ğŸ¤ "å‰è¾ˆï¼ŒæŒ‡æ•™ä¸€ä¸‹æ™šè¾ˆã€‚"', effect: { reputation: 20, money: 30 }, risk: 0.1, next: 2 },
                                { text: 'ğŸ”¥ ç›´æ¥æŠŠä»–çš„é…’æ³¼åœ¨åœ°ä¸Š', effect: { reputation: 60, money: -50 }, risk: 0.4, next: 2 }
                            ]
                        },
                        {
                            character: 'ğŸ’ƒ',
                            name: 'åˆ˜æ€»',
                            role: 'é‡‘ä¸»',
                            text: 'å¥¹å‡ºç°åœ¨ä½ é¢å‰ï¼š"æˆ‘å¯ä»¥å¸®ä½ æå®šæ‰€æœ‰äººã€‚ä½†ä½ è¦æˆä¸º...æˆ‘çš„äººã€‚" å¥¹çš„çœ¼ç¥å……æ»¡å æœ‰æ¬²ã€‚',
                            scene: 'ğŸ’«',
                            sceneName: 'é¡¶æ¥¼å¥—æˆ¿',
                            choices: [
                                { text: 'ğŸ‘‘ "æˆ‘æ˜¯æˆ‘è‡ªå·±çš„äººã€‚ä½†æˆ‘ä»¬å¯ä»¥å¹¶è‚©ä½œæˆ˜ã€‚"', effect: { reputation: 40, money: 80 }, risk: 0.15, next: 'stage3' },
                                { text: 'ğŸ’‹ "ä»Šæ™šï¼Œæˆ‘æ˜¯ä½ çš„ã€‚"', effect: { money: 150, reputation: 20 }, risk: 0.22, next: 'stage3' },
                                { text: 'ğŸš« "å¯¹ä¸èµ·ï¼Œæˆ‘ä¸æ˜¯ä»»ä½•äººçš„é™„å±å“ã€‚"', effect: { reputation: 50, money: -50 }, risk: 0.28, next: 'stage3' }
                            ]
                        }
                    ]
                },
                {
                    scenes: [
                        {
                            character: 'ğŸ‘”',
                            name: 'ä½ ',
                            role: 'å¤œåº—æ–°è´µ',
                            text: 'ä¸€åˆ‡å‡†å¤‡å°±ç»ªã€‚è€ç‹çš„è‚¡ä»½ã€åˆ˜æ€»çš„èµ„é‡‘ã€é»‘å¸®çš„å…³ç³»...åªå·®æœ€åä¸€æ­¥ï¼Œä½ å°±æ˜¯è¿™ä¸ªåŸå¸‚çš„å¤œç‹ã€‚',
                            scene: 'ğŸŒ†',
                            sceneName: 'å¸å›½å¤§å¦é¡¶æ¥¼',
                            choices: [
                                { text: 'âš”ï¸ "æ‰€æœ‰äººéƒ½è¦å¬æˆ‘çš„å‘½ä»¤ã€‚"', effect: { money: 200, reputation: 60 }, risk: 0.28, next: 1 },
                                { text: 'ğŸ¤ "è®©æˆ‘ä»¬å»ºç«‹ä¸€ä¸ªè”ç›Ÿã€‚"', effect: { money: 120, reputation: 80 }, risk: 0.12, next: 1 },
                                { text: 'ğŸ­ "åœ¨æš—å¤„æŒæ§ä¸€åˆ‡æ›´å®‰å…¨ã€‚"', effect: { money: 150, reputation: 40 }, risk: 0.18, next: 1 }
                            ]
                        },
                        {
                            character: 'ğŸª',
                            name: 'ç³»ç»Ÿ',
                            role: 'æœ€ç»ˆè¯•ç‚¼',
                            text: 'æ‰€æœ‰äººéƒ½åœ¨ç­‰ä½ çš„å†³å®šã€‚åˆ˜æ€»ã€å°ç¾ã€é»‘å¸®ã€ç«äº‰å¯¹æ‰‹...è¿™ä¸ªåŸå¸‚çš„å¤œæ™šå±äºè°ï¼Ÿ',
                            scene: 'âš¡',
                            sceneName: 'å‘½è¿æ—¶åˆ»',
                            choices: [
                                { text: 'ğŸ‘‘ ç‹¬éœ¸å¤©ä¸‹â€”â€”æˆ‘å°±æ˜¯è§„åˆ™', effect: { money: 300, reputation: 100 }, risk: 0.4, next: 2, final: true },
                                { text: 'ğŸ¤ å…±å»ºå¸å›½â€”â€”å›¢ç»“ä¸€åˆ‡åŠ›é‡', effect: { money: 200, reputation: 150 }, risk: 0.15, next: 2, final: true },
                                { text: 'ğŸ”¥ æ¨ç¿»é‡æ¥â€”â€”æ—§ç§©åºå¿…é¡»æ­»', effect: { money: 100, reputation: 200 }, risk: 0.3, next: 2, final: true }
                            ]
                        },
                        {
                            character: 'ğŸ†',
                            name: 'å‘½è¿',
                            role: 'æœ€ç»ˆå®¡åˆ¤',
                            text: 'å¸å›½çš„ç‹åº§å°±åœ¨çœ¼å‰ã€‚ä½ å‡†å¤‡å¥½äº†å—ï¼Ÿ',
                            scene: 'ğŸ°',
                            sceneName: 'å‘½è¿ä¹‹è½®',
                            choices: [
                                { text: 'ğŸ‘‘ "è¿™åº§åŸå¸‚ï¼Œåªèƒ½æœ‰ä¸€ä¸ªç‹ã€‚"', effect: { reputation: 50 }, risk: 0.55, next: 'ending', final: true },
                                { text: 'ğŸ™ "æ„Ÿè°¢ä¸€è·¯èµ°æ¥çš„æ‰€æœ‰äººã€‚"', effect: { reputation: 30, money: 50 }, risk: 0.35, next: 'ending', final: true },
                                { text: 'ğŸ˜ˆ "æ¥ä¸‹æ¥ï¼Œæˆ‘è¦çš„æ›´å¤šã€‚"', effect: { reputation: 100, money: -50 }, risk: 0.45, next: 'ending', final: true }
                            ]
                        }
                    ]
                }
            ]
        };
        
        let timerInterval;
        let currentSceneIndex = 0;
        let currentStageIndex = 0;
        
        // æ˜¾ç¤ºè·¯çº¿é€‰æ‹©å¼¹çª—
        function showRouteSelection() {
            if (!userData.hasFreePlayed) {
                // ç¬¬ä¸€æ¬¡å…è´¹ï¼Œç›´æ¥æ˜¾ç¤ºè·¯çº¿é€‰æ‹©
                document.getElementById('routeModal').classList.remove('hidden');
            } else {
                // éœ€è¦å…ˆæ”¯ä»˜
                showPaymentModal();
            }
        }
        
        // å…³é—­è·¯çº¿é€‰æ‹©å¼¹çª—
        function closeRouteModal() {
            document.getElementById('routeModal').classList.add('hidden');
        }
        
        // ç¡®è®¤è·¯çº¿å¹¶å¼€å§‹æ¸¸æˆ
        function confirmRouteAndStart(route) {
            closeRouteModal();
            startGame(route);
        }
        
        // æ˜¾ç¤ºæ”¯ä»˜å¼¹çª—
        function showPaymentModal() {
            document.getElementById('modalWinCount').textContent = userData.totalWins;
            document.getElementById('modalRemaining').textContent = 3 - userData.totalWins;
            document.getElementById('paymentModal').classList.remove('hidden');
        }
        
        // å…³é—­æ”¯ä»˜å¼¹çª—
        function closePaymentModal() {
            document.getElementById('paymentModal').classList.add('hidden');
        }
        
        // å¤„ç†æ”¯ä»˜åæ˜¾ç¤ºè·¯çº¿é€‰æ‹©
        function processPaymentAndShowRoute() {
            // æ¨¡æ‹Ÿæ”¯ä»˜æˆåŠŸ
            closePaymentModal();
            // æ”¯ä»˜æˆåŠŸåæ˜¾ç¤ºè·¯çº¿é€‰æ‹©
            document.getElementById('routeModal').classList.remove('hidden');
        }
        
        // æ£€æŸ¥æ˜¯å¦ä¸ºåœ°ç‹±éš¾åº¦ï¼ˆç¬¬ä¸‰æ¬¡é€šå…³å°è¯•ï¼‰
        function isHellMode() {
            return userData.totalWins === 2;
        }
        
        // è·å–éš¾åº¦å€ç‡
        function getDifficultyMultiplier() {
            if (isHellMode()) {
                return 3.5; // åœ°ç‹±éš¾åº¦ï¼šé£é™©å€¼ä¹˜ä»¥3.5å€
            }
            return 1;
        }
        
        // å¼€å§‹æ¸¸æˆ
        function startGame(route) {
            gameState.route = route;
            gameState.startTime = Date.now();
            gameState.money = route === 'female' ? 50 : 80;
            gameState.reputation = route === 'female' ? 30 : 20;
            gameState.energy = isHellMode() ? 70 : 100; // åœ°ç‹±éš¾åº¦åˆå§‹ç²¾åŠ›é™ä½
            gameState.stage = 0;
            gameState.alive = true;
            gameState.perfect = true;
            gameState.isHellMode = isHellMode();
            currentSceneIndex = 0;
            currentStageIndex = 0;
            
            // æ ‡è®°å·²ä½¿ç”¨å…è´¹æ¬¡æ•°
            if (!userData.hasFreePlayed) {
                userData.hasFreePlayed = true;
                saveUserData();
            }
            
            userData.totalPlays++;
            saveUserData();
            
            document.getElementById('startScreen').classList.add('hidden');
            document.getElementById('gameScreen').classList.remove('hidden');
            document.getElementById('statusBar').classList.remove('hidden');
            
            document.getElementById('winCount').textContent = userData.totalWins;
            
            // æ˜¾ç¤ºåœ°ç‹±éš¾åº¦è­¦å‘Š
            if (gameState.isHellMode) {
                showHellModeWarning();
            }
            
            updateStatus();
            startTimer();
            showScene();
            
            createParticles();
        }
        
        // æ˜¾ç¤ºåœ°ç‹±éš¾åº¦è­¦å‘Š
        function showHellModeWarning() {
            const warning = document.createElement('div');
            warning.className = 'fixed inset-0 bg-red-900/80 z-50 flex items-center justify-center';
            warning.innerHTML = `
                <div class="text-center modal-animate">
                    <div class="text-8xl mb-4 heartbeat">ğŸ‘¹</div>
                    <h2 class="cyber-font text-4xl text-red-500 neon-pink mb-4">åœ°ç‹±éš¾åº¦</h2>
                    <p class="text-xl text-white mb-2">æœ€åä¸€å…³ï¼æˆåŠŸå³å¯å†²å‡»å¤§å¥–ï¼</p>
                    <p class="text-gray-300 mb-6">âš ï¸ é£é™©æå‡300%  âš¡ åˆå§‹ç²¾åŠ›-30%</p>
                    <p class="text-yellow-400 text-sm mb-4">é€šå…³æ¦‚ç‡: 0.001%</p>
                </div>
            `;
            document.body.appendChild(warning);
            
            setTimeout(() => {
                warning.style.transition = 'opacity 0.5s';
                warning.style.opacity = '0';
                setTimeout(() => warning.remove(), 500);
            }, 2500);
        }
        
        // æ˜¾ç¤ºåœºæ™¯
        function showScene() {
            const route = stories[gameState.route];
            if (currentStageIndex >= route.length) {
                showEnding(true);
                return;
            }
            
            const stage = route[currentStageIndex];
            if (currentSceneIndex >= stage.scenes.length) {
                currentStageIndex++;
                currentSceneIndex = 0;
                gameState.stage = currentStageIndex;
                updateProgress();
                
                if (currentStageIndex >= route.length) {
                    showEnding(true);
                    return;
                }
            }
            
            const scene = stage.scenes[currentSceneIndex];
            
            document.getElementById('characterEmoji').textContent = scene.character;
            document.getElementById('characterName').textContent = scene.name;
            document.getElementById('characterRole').textContent = scene.role;
            document.getElementById('storyText').innerHTML = scene.text;
            document.getElementById('sceneEmoji').textContent = scene.scene;
            document.getElementById('sceneName').textContent = scene.sceneName;
            
            const choicesArea = document.getElementById('choicesArea');
            choicesArea.innerHTML = '';
            
            scene.choices.forEach((choice, index) => {
                // åœ°ç‹±éš¾åº¦ä¸‹é£é™©å€¼ä¹˜ä»¥å€ç‡
                const actualRisk = Math.min(choice.risk * getDifficultyMultiplier(), 0.95);
                const isRisky = actualRisk > 0.2;
                const btn = document.createElement('button');
                btn.className = `choice-card ${isRisky ? 'risky' : ''} w-full p-4 rounded-xl text-left fade-in-up`;
                btn.style.animationDelay = `${index * 0.1}s`;
                
                let riskLabel = '';
                if (gameState.isHellMode) {
                    riskLabel = '<span class="text-red-500 text-xs ml-2">ğŸ”¥ åœ°ç‹±éš¾åº¦</span>';
                } else if (choice.risk > 0.4) riskLabel = '<span class="text-red-500 text-xs ml-2">âš ï¸ æåº¦å±é™©</span>';
                else if (choice.risk > 0.2) riskLabel = '<span class="text-orange-500 text-xs ml-2">âš¡ é«˜é£é™©</span>';
                else if (choice.risk > 0.1) riskLabel = '<span class="text-yellow-500 text-xs ml-2">~ æœ‰é£é™©</span>';
                
                btn.innerHTML = `
                    <div class="flex items-center justify-between">
                        <span class="text-gray-200">${choice.text}</span>
                        ${riskLabel}
                    </div>
                    <div class="flex gap-3 mt-2 text-xs text-gray-500">
                        ${choice.effect.money ? `<span class="${choice.effect.money > 0 ? 'text-green-400' : 'text-red-400'}">ğŸ’°${choice.effect.money > 0 ? '+' : ''}${choice.effect.money}</span>` : ''}
                        ${choice.effect.reputation ? `<span class="${choice.effect.reputation > 0 ? 'text-pink-400' : 'text-red-400'}">ğŸ”¥${choice.effect.reputation > 0 ? '+' : ''}${choice.effect.reputation}</span>` : ''}
                        ${choice.effect.energy ? `<span class="${choice.effect.energy > 0 ? 'text-cyan-400' : 'text-orange-400'}">âš¡${choice.effect.energy > 0 ? '+' : ''}${choice.effect.energy}</span>` : ''}
                    </div>
                `;
                
                btn.onclick = () => makeChoice(choice, index);
                choicesArea.appendChild(btn);
            });
            
            updateRank();
        }
        
        // åšå‡ºé€‰æ‹©
        function makeChoice(choice, index) {
            gameState.money += choice.effect.money || 0;
            gameState.reputation += choice.effect.reputation || 0;
            gameState.energy += choice.effect.energy || 0;
            
            gameState.choices.push({
                stage: currentStageIndex,
                scene: currentSceneIndex,
                choice: index,
                risk: choice.risk
            });
            
            const roll = Math.random();
            if (roll < choice.risk) {
                if (choice.risk > 0.4) {
                    gameState.alive = false;
                    showGameOver('é£é™©å¤ªé«˜ï¼Œä½ çš„é‡å¿ƒåå™¬äº†ä½ ...');
                    return;
                } else {
                    gameState.money = Math.max(0, gameState.money - 50);
                    gameState.reputation = Math.max(0, gameState.reputation - 20);
                    gameState.perfect = false;
                    showWarning();
                }
            } else if (choice.risk > 0.2) {
                gameState.money += 30;
                gameState.reputation += 15;
                showSuccess();
            }
            
            if (gameState.energy <= 0) {
                showGameOver('ä½ çš„ç²¾åŠ›è€—å°½äº†...è¿™ä¸ªä¸–ç•Œä¸æ˜¯ä¸ºå¼±è€…å‡†å¤‡çš„ã€‚');
                return;
            }
            
            updateStatus();
            
            if (choice.next === 'badend') {
                showGameOver('ä½ é€‰æ‹©äº†çˆ±æƒ…ï¼Œå´å¤±å»äº†ä¸€åˆ‡ã€‚è¿™ä¸ªä¸–ç•Œæ²¡æœ‰ç«¥è¯ã€‚');
                return;
            }
            
            if (choice.next === 'ending') {
                finalJudgement();
                return;
            }
            
            if (typeof choice.next === 'string' && choice.next.startsWith('stage')) {
                currentStageIndex++;
                currentSceneIndex = 0;
            } else {
                currentSceneIndex++;
            }
            
            setTimeout(showScene, 500);
        }
        
        function updateStatus() {
            document.getElementById('money').textContent = gameState.money;
            document.getElementById('reputation').textContent = gameState.reputation;
            document.getElementById('energy').textContent = Math.max(0, gameState.energy);
            updateProgress();
        }
        
        function updateProgress() {
            const totalStages = 4;
            const progress = (currentStageIndex / totalStages) * 100;
            document.getElementById('progressBar').style.width = `${Math.min(progress, 100)}%`;
        }
        
        function updateRank() {
            const rankChange = Math.floor(Math.random() * 200) - 100;
            gameState.rank = Math.max(1, gameState.rank + rankChange);
            document.getElementById('currentRank').textContent = `#${gameState.rank.toLocaleString()}`;
        }
        
        function startTimer() {
            timerInterval = setInterval(() => {
                const elapsed = Math.floor((Date.now() - gameState.startTime) / 1000);
                const remaining = gameState.totalTime - elapsed;
                
                if (remaining <= 0) {
                    clearInterval(timerInterval);
                    showGameOver('æ—¶é—´åˆ°ï¼å¸å›½æ¢¦ç¢...');
                    return;
                }
                
                const minutes = Math.floor(remaining / 60);
                const seconds = remaining % 60;
                document.getElementById('gameTimer').textContent = 
                    `${minutes}:${seconds.toString().padStart(2, '0')}`;
                
                if (remaining < 60) {
                    document.getElementById('gameTimer').classList.add('heartbeat');
                }
            }, 1000);
        }
        
        function showWarning() {
            const container = document.getElementById('gameContainer');
            container.classList.add('shake');
            setTimeout(() => container.classList.remove('shake'), 500);
        }
        
        function showSuccess() {
            createSuccessParticles();
        }
        
        function finalJudgement() {
            let successRate = 0.5;
            
            if (gameState.money >= 300) successRate += 0.1;
            if (gameState.reputation >= 150) successRate += 0.1;
            if (gameState.energy >= 50) successRate += 0.05;
            if (gameState.perfect) successRate += 0.15;
            
            successRate = Math.min(successRate, 0.9);
            
            const roll = Math.random();
            
            showFateWheel(roll < successRate);
        }
        
        function showFateWheel(success) {
            const choicesArea = document.getElementById('choicesArea');
            choicesArea.innerHTML = `
                <div class="text-center py-8">
                    <div class="text-6xl mb-4 heartbeat">ğŸ°</div>
                    <p class="text-xl text-gray-300 mb-4">å‘½è¿ä¹‹è½®æ­£åœ¨è½¬åŠ¨...</p>
                    <div class="w-full h-2 bg-gray-800 rounded-full overflow-hidden">
                        <div class="h-full bg-gradient-to-r from-pink-500 via-yellow-500 to-cyan-500 animate-pulse" style="animation: progressGlow 0.5s linear infinite;"></div>
                    </div>
                </div>
            `;
            
            setTimeout(() => {
                if (success) {
                    showEnding(true);
                } else {
                    showGameOver('å‘½è¿å¥³ç¥æ²¡æœ‰çœ·é¡¾ä½ ...å·®ä¸€ç‚¹å°±æˆåŠŸäº†ã€‚');
                }
            }, 3000);
        }
        
        function showEnding(won) {
            clearInterval(timerInterval);
            
            // å¢åŠ é€šå…³æ¬¡æ•°
            userData.totalWins++;
            saveUserData();
            
            document.getElementById('gameScreen').classList.add('hidden');
            document.getElementById('statusBar').classList.add('hidden');
            document.getElementById('resultScreen').classList.remove('hidden');
            
            const title = gameState.route === 'female' ? 'å¥³ç‹BOSS' : 'éœ¸é“æ€»è£';
            const elapsed = Math.floor((Date.now() - gameState.startTime) / 1000);
            const minutes = Math.floor(elapsed / 60);
            const seconds = elapsed % 60;
            const remaining = 3 - userData.totalWins;
            
            // æ£€æŸ¥æ˜¯å¦è·å¾—å¤§å¥–ï¼ˆè¾¾åˆ°3æ¬¡ä¸”0.001%æ¦‚ç‡ï¼‰
            let grandPrize = false;
            let luckyPrize = false;
            
            if (userData.totalWins >= 3) {
                // 0.001%æ¦‚ç‡
                if (Math.random() < 0.00001) {
                    grandPrize = true;
                } else if (Math.random() < 0.05) {
                    luckyPrize = true;
                }
            }
            
            if (grandPrize) {
                // æ˜¾ç¤ºå¤§å¥–å¼¹çª—
                setTimeout(() => {
                    showGrandPrizeModal();
                }, 1000);
            }
            
            if (luckyPrize) {
                setTimeout(() => {
                    showLuckyPrizeModal();
                }, 1000);
            }
            
            document.getElementById('resultScreen').innerHTML = `
                <div class="fade-in-up">
                    <div class="text-8xl mb-6 prize-float">ğŸ‘‘</div>
                    <h1 class="cyber-font text-4xl text-yellow-400 neon-gold mb-4">ğŸ‰ é€šå…³æˆåŠŸï¼ğŸ‰</h1>
                    <p class="text-2xl text-white mb-2">ä½ æˆä¸ºäº†ä¼ è¯´ä¸­çš„</p>
                    <p class="cyber-font text-3xl text-pink-400 neon-pink mb-6">${title}</p>
                    
                    <div class="bg-gradient-to-r from-green-900/30 to-cyan-900/30 rounded-2xl p-4 mb-6 border border-green-500/50">
                        <p class="text-green-400 cyber-font mb-2">ğŸ¯ é€šå…³è¿›åº¦</p>
                        <div class="flex items-center justify-center gap-4 text-2xl">
                            <span class="cyber-font text-white">${userData.totalWins}</span>
                            <span class="text-gray-500">/</span>
                            <span class="cyber-font text-yellow-400">3</span>
                        </div>
                        <div class="h-3 bg-gray-800 rounded-full overflow-hidden mt-3">
                            <div class="win-progress h-full rounded-full" style="width: ${Math.min((userData.totalWins / 3) * 100, 100)}%"></div>
                        </div>
                        ${remaining > 0 ? `
                            <p class="text-gray-400 mt-3">è·ç¦» PS5 å¤§å¥–è¿˜éœ€é€šå…³ <span class="text-yellow-400 cyber-font">${remaining}</span> æ¬¡ï¼</p>
                        ` : `
                            <p class="text-yellow-400 mt-3">ğŸ° å·²è¾¾æˆé€šå…³ç›®æ ‡ï¼Œè¿›å…¥å¤§å¥–æŠ½å–æ± ï¼</p>
                        `}
                    </div>
                    
                    <div class="grid grid-cols-3 gap-4 mb-6">
                        <div class="bg-black/30 rounded-xl p-4">
                            <p class="text-3xl">ğŸ’°</p>
                            <p class="cyber-font text-green-400 text-xl">${gameState.money}</p>
                            <p class="text-xs text-gray-500">æœ€ç»ˆèµ„é‡‘</p>
                        </div>
                        <div class="bg-black/30 rounded-xl p-4">
                            <p class="text-3xl">ğŸ”¥</p>
                            <p class="cyber-font text-pink-400 text-xl">${gameState.reputation}</p>
                            <p class="text-xs text-gray-500">æœ€ç»ˆå£°æœ›</p>
                        </div>
                        <div class="bg-black/30 rounded-xl p-4">
                            <p class="text-3xl">â±ï¸</p>
                            <p class="cyber-font text-cyan-400 text-xl">${minutes}:${seconds.toString().padStart(2, '0')}</p>
                            <p class="text-xs text-gray-500">é€šå…³æ—¶é—´</p>
                        </div>
                    </div>
                    
                    <div class="neon-box-gold rounded-xl p-4 bg-black/30 mb-6">
                        <p class="text-yellow-400 text-sm">ğŸ® ç»§ç»­æŒ‘æˆ˜ï¼ŒPS5 å¤§å¥–ç­‰ä½ æ¥æ‹¿ï¼</p>
                        <p class="text-xs text-gray-500 mt-1">å¤§å¥–æ¦‚ç‡: 0.001% | å¹¸è¿å¥–: éœ¸å±åˆ¸</p>
                    </div>
                    
                    <button onclick="location.reload()" class="cyber-btn bg-gradient-to-r from-pink-600 to-purple-600 px-8 py-3 rounded-xl text-lg font-bold hover:opacity-90 neon-box-pink">
                        ğŸ”„ å†æ¥ä¸€æ¬¡ ${userData.hasFreePlayed ? '(Â¥10)' : '(å…è´¹)'}
                    </button>
                </div>
            `;
            
            createVictoryParticles();
        }
        
        function showGameOver(reason) {
            clearInterval(timerInterval);
            document.getElementById('gameScreen').classList.add('hidden');
            document.getElementById('statusBar').classList.add('hidden');
            document.getElementById('resultScreen').classList.remove('hidden');
            
            const elapsed = Math.floor((Date.now() - gameState.startTime) / 1000);
            const minutes = Math.floor(elapsed / 60);
            const seconds = elapsed % 60;
            const remaining = 3 - userData.totalWins;
            
            document.getElementById('resultScreen').innerHTML = `
                <div class="fade-in-up">
                    <div class="text-8xl mb-6">ğŸ’€</div>
                    <h1 class="cyber-font text-3xl text-red-500 mb-4">æ¸¸æˆç»“æŸ</h1>
                    <p class="text-gray-300 mb-6">${reason}</p>
                    
                    <div class="bg-red-900/20 rounded-xl p-4 mb-6 border border-red-500/30">
                        <p class="text-red-400 text-lg mb-2">ğŸ˜¢ è·ç¦» PS5 å¤§å¥–è¿˜å·® <span class="cyber-font text-yellow-400">${remaining}</span> æ¬¡é€šå…³</p>
                        <p class="text-gray-400 text-sm">å½“å‰è¿›åº¦: ${userData.totalWins} / 3</p>
                    </div>
                    
                    <div class="bg-black/50 rounded-xl p-6 mb-6 border border-gray-700">
                        <p class="text-gray-400 mb-4">æœ¬å±€æ•°æ®:</p>
                        <div class="grid grid-cols-3 gap-4">
                            <div>
                                <p class="cyber-font text-green-400 text-xl">${gameState.money}</p>
                                <p class="text-xs text-gray-500">èµ„é‡‘</p>
                            </div>
                            <div>
                                <p class="cyber-font text-pink-400 text-xl">${gameState.reputation}</p>
                                <p class="text-xs text-gray-500">å£°æœ›</p>
                            </div>
                            <div>
                                <p class="cyber-font text-cyan-400 text-xl">${minutes}:${seconds.toString().padStart(2, '0')}</p>
                                <p class="text-xs text-gray-500">æ¸¸æˆæ—¶é—´</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mb-6 neon-box-gold rounded-xl p-4 bg-black/30">
                        <p class="text-yellow-400 text-sm">ğŸ® åˆ«ç°å¿ƒï¼PS5 å¤§å¥–ä¾ç„¶åœ¨ç­‰ä½ ï¼</p>
                        <p class="text-xs text-gray-500 mt-1">å¤§å¥–æ¦‚ç‡: 0.001% | å½“å‰åœ¨çº¿: 12,847</p>
                    </div>
                    
                    <button onclick="location.reload()" class="cyber-btn bg-gradient-to-r from-red-600 to-orange-600 px-8 py-3 rounded-xl text-lg font-bold hover:opacity-90">
                        ğŸ”„ å†è¯•ä¸€æ¬¡ ${userData.hasFreePlayed ? '(Â¥10)' : '(å…è´¹)'}
                    </button>
                </div>
            `;
        }
        
        // æ˜¾ç¤ºå¤§å¥–å¼¹çª—
        function showGrandPrizeModal() {
            document.getElementById('prizeModal').classList.remove('hidden');
            createConfetti();
            
            document.getElementById('addressForm').onsubmit = function(e) {
                e.preventDefault();
                alert('ğŸ‰ æ­å–œï¼æ‚¨çš„é¢†å¥–ä¿¡æ¯å·²æäº¤æˆåŠŸï¼æˆ‘ä»¬å°†åœ¨7ä¸ªå·¥ä½œæ—¥å†…å‘è´§ï¼Œè¯·ä¿æŒç”µè¯ç•…é€šï¼');
                document.getElementById('prizeModal').classList.add('hidden');
            };
        }
        
        // æ˜¾ç¤ºå¹¸è¿å¥–å¼¹çª—
        function showLuckyPrizeModal() {
            document.getElementById('luckyPrizeModal').classList.remove('hidden');
        }
        
        function closeLuckyPrizeModal() {
            document.getElementById('luckyPrizeModal').classList.add('hidden');
        }
        
        // åˆ›å»ºå½©å¸¦æ•ˆæœ
        function createConfetti() {
            const container = document.getElementById('confettiContainer');
            const colors = ['#ff2d95', '#00f7ff', '#ffd700', '#ff6b6b', '#4ade80', '#a855f7'];
            
            for (let i = 0; i < 100; i++) {
                setTimeout(() => {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti';
                    confetti.style.position = 'absolute';
                    confetti.style.left = Math.random() * 100 + '%';
                    confetti.style.top = '-20px';
                    confetti.style.width = (5 + Math.random() * 10) + 'px';
                    confetti.style.height = (10 + Math.random() * 20) + 'px';
                    confetti.style.background = colors[Math.floor(Math.random() * colors.length)];
                    confetti.style.animationDuration = (2 + Math.random() * 2) + 's';
                    container.appendChild(confetti);
                    
                    setTimeout(() => confetti.remove(), 4000);
                }, i * 30);
            }
        }
        
        function createParticles() {
            const container = document.getElementById('particleContainer');
            setInterval(() => {
                if (document.getElementById('gameScreen').classList.contains('hidden')) return;
                
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.bottom = '0';
                particle.style.width = '4px';
                particle.style.height = '4px';
                particle.style.background = ['#ff2d95', '#00f7ff', '#ffd700'][Math.floor(Math.random() * 3)];
                container.appendChild(particle);
                
                setTimeout(() => particle.remove(), 3000);
            }, 500);
        }
        
        function createSuccessParticles() {
            const container = document.getElementById('particleContainer');
            for (let i = 0; i < 20; i++) {
                setTimeout(() => {
                    const particle = document.createElement('div');
                    particle.className = 'particle';
                    particle.style.left = 50 + (Math.random() - 0.5) * 30 + '%';
                    particle.style.top = '50%';
                    particle.style.width = '8px';
                    particle.style.height = '8px';
                    particle.style.background = '#ffd700';
                    particle.innerHTML = 'âœ¦';
                    particle.style.fontSize = '20px';
                    container.appendChild(particle);
                    
                    setTimeout(() => particle.remove(), 1500);
                }, i * 50);
            }
        }
        
        function createVictoryParticles() {
            const container = document.getElementById('particleContainer');
            const colors = ['#ff2d95', '#00f7ff', '#ffd700', '#ff6b6b', '#4ade80'];
            const emojis = ['âœ¨', 'ğŸŒŸ', 'ğŸ’«', 'â­', 'ğŸ‰', 'ğŸŠ', 'ğŸ’'];
            
            for (let i = 0; i < 50; i++) {
                setTimeout(() => {
                    const particle = document.createElement('div');
                    particle.className = 'particle';
                    particle.style.left = Math.random() * 100 + '%';
                    particle.style.top = Math.random() * 100 + '%';
                    particle.innerHTML = emojis[Math.floor(Math.random() * emojis.length)];
                    particle.style.fontSize = (15 + Math.random() * 20) + 'px';
                    particle.style.color = colors[Math.floor(Math.random() * colors.length)];
                    container.appendChild(particle);
                    
                    setTimeout(() => particle.remove(), 3000);
                }, i * 100);
            }
        }
        
        // åˆå§‹åŒ–
        loadUserData();
    </script>
</body>
</html>
